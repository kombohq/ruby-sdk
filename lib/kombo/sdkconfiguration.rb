# Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

# typed: true
# frozen_string_literal: true

require 'faraday'
require 'faraday/multipart'
require 'faraday/retry'
require 'sorbet-runtime'
require_relative 'sdk_hooks/hooks'
require_relative 'utils/retries'

module Kombo
  extend T::Sig

  SERVER_EU = :eu # Kombo EU Region
  SERVER_US = :us # Kombo US Region
  SERVERS = {
    eu: 'https://api.kombo.dev/v1',
    us: 'https://api.us.kombo.dev/v1',
  }.freeze
  SERVERS = T.let(SERVERS, T::Hash[T.any(String, Symbol), String])
  # Contains the list of servers available to the SDK

  class SDKConfiguration
    extend T::Sig

    sig { returns(T.nilable(Faraday::Connection)) }
    attr_accessor :client

    sig { returns(::Kombo::SDKHooks::Hooks) }
    attr_accessor :hooks

    sig { returns(T.nilable(::Kombo::Utils::RetryConfig)) }
    attr_accessor :retry_config

    sig { returns(T.nilable(Float)) }
    attr_accessor :timeout

    
    sig { returns(T.nilable(T.proc.returns(T.nilable(Models::Shared::Security)))) }
    attr_accessor :security_source

    
    sig { returns(T.nilable(String)) }
    attr_accessor :server_url

    
    sig { returns(Symbol) }
    attr_accessor :server

    
    sig { returns(T::Hash[Symbol, T::Hash[Symbol, T::Hash[Symbol, Object]]]) }
    attr_accessor :globals

    
    sig { returns(String) }
    attr_accessor :language

    sig { returns(String) }
    attr_accessor :openapi_doc_version

    sig { returns(String) }
    attr_accessor :sdk_version

    sig { returns(String) }
    attr_accessor :gen_version

    sig { returns(String) }
    attr_accessor :user_agent

    sig do
      params(
        client: T.nilable(Faraday::Connection),
        hooks: ::Kombo::SDKHooks::Hooks,
        retry_config: T.nilable(::Kombo::Utils::RetryConfig),
        timeout_ms: T.nilable(Integer),
        security: T.nilable(Models::Shared::Security),
        security_source: T.nilable(T.proc.returns(Models::Shared::Security)),
        server_url: T.nilable(String),
        server: T.nilable(Symbol),
        globals: T.nilable(T::Hash[Symbol, T::Hash[Symbol, T::Hash[Symbol, Object]]])
      ).void
    end
    def initialize(client, hooks, retry_config, timeout_ms, security, security_source, server_url, server, globals)
      @client = client
      @hooks = hooks
      @retry_config = retry_config
      @server_url = server_url
      @timeout = (timeout_ms.to_f / 1000) unless timeout_ms.nil?
      @server = server.nil? ? SERVER_EU : server
      raise StandardError, "Invalid server \"#{server}\"" if !SERVERS.key?(@server)
      if !security_source.nil?
        @security_source = security_source
      elsif !security.nil?
        @security_source = -> { security }
      end
      @globals = globals.nil? ? {} : globals
      @language = 'ruby'
      @openapi_doc_version = '1.0.0'
      @sdk_version = '1.0.2'
      @gen_version = '2.801.2'
      @user_agent = 'speakeasy-sdk/ruby 1.0.2 2.801.2 1.0.0 kombo'
    end

    sig { returns([String, T::Hash[Symbol, String]]) }
    def get_server_details
      return [@server_url.delete_suffix('/'), {}] if !@server_url.nil?
      @server = T.must(@server)
      [T.must(SERVERS[@server]), {}]
    end
  end
end
